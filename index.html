<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Collapse of Consumer Surplus</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #fff;
            color: #333;
            line-height: 1.5;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 16px 16px 24px;
        }
        
        header {
            text-align: center;
            margin-bottom: 16px;
        }
        
        h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            color: #000;
            letter-spacing: -0.3px;
            line-height: 1.2;
        }
        
        .subtitle {
            font-size: 14px;
            color: #666;
            font-weight: 400;
            line-height: 1.3;
        }
        
        .year-display {
            text-align: center;
            font-size: 48px;
            font-weight: 700;
            margin: 12px 0 6px;
            color: #000;
            letter-spacing: -1.5px;
        }
        
        .era-label {
            text-align: center;
            font-size: 12px;
            color: #999;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1.2px;
        }
        
        /* Metrics */
        .metrics {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 12px 0 16px;
        }
        
        .metric {
            text-align: center;
        }
        
        .metric-value {
            font-size: 36px;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 4px;
        }
        
        .metric-value.cs {
            color: #4A90E2;
        }
        
        .metric-value.dwl {
            color: #E24A4A;
        }
        
        .metric-label {
            font-size: 10px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }
        
        /* Main viz */
        .viz-container {
            position: relative;
            margin: 16px auto;
            width: 100%;
            max-width: 700px;
        }
        
        svg {
            display: block;
            width: 100%;
            height: auto;
        }
        
        /* Timeline */
        .timeline-container {
            max-width: 700px;
            margin: 0 auto 20px;
            padding: 0 8px;
        }
        
        .timeline-slider {
            position: relative;
            height: 40px;
        }
        
        input[type="range"] {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
            position: relative;
            top: 17px;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #000;
            cursor: pointer;
            box-shadow: 0 1px 4px rgba(0,0,0,0.25);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #000;
            cursor: pointer;
            border: none;
            box-shadow: 0 1px 4px rgba(0,0,0,0.25);
        }
        
        .timeline-markers {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 10px;
            color: #999;
        }
        
        .timeline-marker.major {
            font-weight: 600;
            color: #333;
        }
        
        /* Structural changes */
        .changes-timeline {
            max-width: 700px;
            margin: 20px auto 0;
            padding: 20px 0 0;
            border-top: 1px solid #e0e0e0;
        }
        
        .changes-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 16px;
            text-align: center;
        }
        
        .change-item {
            margin: 12px 0;
            padding-left: 12px;
            border-left: 3px solid #e0e0e0;
            opacity: 0.3;
            transition: all 0.3s ease;
        }
        
        .change-item.active {
            border-left-color: #E24A4A;
            opacity: 1;
        }
        
        .change-year {
            font-size: 11px;
            color: #999;
            font-weight: 600;
            margin-bottom: 3px;
        }
        
        .change-title {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 4px;
            color: #000;
        }
        
        .change-description {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }
        
        /* Mobile optimizations */
        @media (max-width: 600px) {
            .container {
                padding: 12px 12px 20px;
            }
            
            h1 {
                font-size: 20px;
                margin-bottom: 6px;
            }
            
            .subtitle {
                font-size: 13px;
            }
            
            .year-display {
                font-size: 40px;
                margin: 10px 0 5px;
            }
            
            .era-label {
                font-size: 11px;
                margin-bottom: 10px;
            }
            
            .metrics {
                gap: 28px;
                margin: 10px 0 12px;
            }
            
            .metric-value {
                font-size: 32px;
            }
            
            .metric-label {
                font-size: 9px;
            }
            
            .viz-container {
                margin: 12px auto;
            }
            
            .timeline-container {
                margin: 0 auto 16px;
            }
            
            .changes-timeline {
                margin: 16px auto 0;
                padding: 16px 0 0;
            }
            
            .changes-title {
                font-size: 15px;
                margin-bottom: 12px;
            }
            
            .change-item {
                margin: 10px 0;
            }
            
            .change-title {
                font-size: 12px;
            }
            
            .change-description {
                font-size: 11px;
            }
        }
        
        @media (max-width: 400px) {
            h1 {
                font-size: 18px;
            }
            
            .year-display {
                font-size: 36px;
            }
            
            .metrics {
                gap: 20px;
            }
            
            .metric-value {
                font-size: 28px;
            }
            
            .timeline-markers {
                font-size: 9px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>The Collapse of Consumer Surplus</h1>
            <p class="subtitle">How structural changes after 2009 destroyed accessibility to the Super Bowl</p>
        </header>
        
        <div class="year-display" id="yearDisplay">1967</div>
        <div class="era-label" id="eraLabel">The Golden Era</div>
        
        <div class="metrics">
            <div class="metric">
                <div class="metric-value cs" id="csValue">95%</div>
                <div class="metric-label">Consumer Surplus</div>
            </div>
            <div class="metric">
                <div class="metric-value dwl" id="dwlValue">5%</div>
                <div class="metric-label">Deadweight Loss</div>
            </div>
        </div>
        
        <div class="viz-container">
            <svg id="mainViz" viewBox="0 0 700 380" preserveAspectRatio="xMidYMid meet"></svg>
        </div>
        
        <div class="timeline-container">
            <div class="timeline-slider">
                <input type="range" id="yearSlider" min="1967" max="2026" value="1967" step="1">
            </div>
            <div class="timeline-markers">
                <div class="timeline-marker major">1967</div>
                <div class="timeline-marker">1980</div>
                <div class="timeline-marker">2000</div>
                <div class="timeline-marker major">2010</div>
                <div class="timeline-marker">2020</div>
                <div class="timeline-marker major">2026</div>
            </div>
        </div>
        
        <div class="changes-timeline">
            <div class="changes-title">The Three Structural Changes</div>
            
            <div class="change-item" id="change1">
                <div class="change-year">2009-2010</div>
                <div class="change-title">TV Everywhere Authentication</div>
                <div class="change-description">
                    Networks require cable subscription to stream online. Cord-cutters locked out.
                </div>
            </div>
            
            <div class="change-item" id="change2">
                <div class="change-year">Mid-2000s – 2020s</div>
                <div class="change-title">Retransmission Fee Explosion</div>
                <div class="change-description">
                    Networks charge cable companies billions for free broadcasts. Fees increase 3,000%. Cable bills soar.
                </div>
            </div>
            
            <div class="change-item" id="change3">
                <div class="change-year">2010s – 2020s</div>
                <div class="change-title">Vertical Integration</div>
                <div class="change-description">
                    Networks launch streaming platforms. Protecting cable revenue requires restricting access.
                </div>
            </div>
        </div>
    </div>

    <script>
        const data = [
            { year: 1967, accessRate: 0.95, era: "The Golden Era" },
            { year: 1980, accessRate: 0.98, era: "The Golden Era" },
            { year: 1992, accessRate: 0.98, era: "The Golden Era" },
            { year: 2000, accessRate: 0.97, era: "The Golden Era" },
            { year: 2005, accessRate: 0.95, era: "The Golden Era" },
            { year: 2010, accessRate: 0.92, era: "The Structural Break" },
            { year: 2013, accessRate: 0.85, era: "Early Decline" },
            { year: 2015, accessRate: 0.76, era: "Rapid Decline" },
            { year: 2019, accessRate: 0.62, era: "Rapid Decline" },
            { year: 2021, accessRate: 0.56, era: "The Collapse" },
            { year: 2023, accessRate: 0.48, era: "The Collapse" },
            { year: 2025, accessRate: 0.44, era: "The Collapse" },
            { year: 2026, accessRate: 0.42, era: "The Collapse" }
        ];
        
        function interpolate(year) {
            let lower = data[0];
            let upper = data[data.length - 1];
            
            for (let i = 0; i < data.length - 1; i++) {
                if (data[i].year <= year && data[i + 1].year >= year) {
                    lower = data[i];
                    upper = data[i + 1];
                    break;
                }
            }
            
            if (lower.year === upper.year) return lower;
            
            const ratio = (year - lower.year) / (upper.year - lower.year);
            return {
                accessRate: lower.accessRate + (upper.accessRate - lower.accessRate) * ratio,
                era: lower.era
            };
        }
        
        function drawEconomicDiagram(accessRate) {
            const svg = document.getElementById('mainViz');
            const width = 700;
            const height = 380;
            const margin = {top: 45, right: 50, bottom: 45, left: 50};
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            svg.innerHTML = '';

            const xScale = (q) => margin.left + q;
            const yScale = (price) => margin.top + (chartHeight * (1 - price / 100));

            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');

            // Calculate quantities
            const actualQ = chartWidth * accessRate;
            const priceAtQ = 100 * (1 - accessRate);

            // Consumer Surplus
            const cs = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            cs.setAttribute('points', `
                ${xScale(0)},${yScale(100)}
                ${xScale(actualQ)},${yScale(priceAtQ)}
                ${xScale(0)},${yScale(priceAtQ)}
            `);
            cs.setAttribute('fill', '#4A90E2');
            cs.setAttribute('opacity', '0.7');
            cs.setAttribute('stroke', '#2E5C8A');
            cs.setAttribute('stroke-width', '2');
            g.appendChild(cs);

            // Deadweight Loss
            if (accessRate < 0.99) {
                const dwl = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                dwl.setAttribute('points', `
                    ${xScale(actualQ)},${yScale(priceAtQ)}
                    ${xScale(chartWidth)},${yScale(0)}
                    ${xScale(actualQ)},${yScale(0)}
                `);
                dwl.setAttribute('fill', '#E24A4A');
                dwl.setAttribute('opacity', '0.7');
                dwl.setAttribute('stroke', '#B83838');
                dwl.setAttribute('stroke-width', '2');
                g.appendChild(dwl);
            }

            // Demand curve
            const demand = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            demand.setAttribute('x1', xScale(0));
            demand.setAttribute('y1', yScale(100));
            demand.setAttribute('x2', xScale(chartWidth));
            demand.setAttribute('y2', yScale(0));
            demand.setAttribute('stroke', '#333');
            demand.setAttribute('stroke-width', '2.5');
            g.appendChild(demand);

            // MC line
            const mc = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            mc.setAttribute('x1', xScale(0));
            mc.setAttribute('y1', yScale(0));
            mc.setAttribute('x2', xScale(chartWidth));
            mc.setAttribute('y2', yScale(0));
            mc.setAttribute('stroke', '#333');
            mc.setAttribute('stroke-width', '2.5');
            mc.setAttribute('stroke-dasharray', '8,6');
            g.appendChild(mc);

            // Axes
            const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            yAxis.setAttribute('x1', margin.left);
            yAxis.setAttribute('y1', margin.top);
            yAxis.setAttribute('x2', margin.left);
            yAxis.setAttribute('y2', height - margin.bottom);
            yAxis.setAttribute('stroke', '#999');
            yAxis.setAttribute('stroke-width', '1.5');
            g.appendChild(yAxis);

            const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            xAxis.setAttribute('x1', margin.left);
            xAxis.setAttribute('y1', height - margin.bottom);
            xAxis.setAttribute('x2', width - margin.right);
            xAxis.setAttribute('y2', height - margin.bottom);
            xAxis.setAttribute('stroke', '#999');
            xAxis.setAttribute('stroke-width', '1.5');
            g.appendChild(xAxis);

            // Labels
            const demandLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            demandLabel.setAttribute('x', width - margin.right + 8);
            demandLabel.setAttribute('y', yScale(0) - 5);
            demandLabel.setAttribute('font-size', '11');
            demandLabel.setAttribute('fill', '#666');
            demandLabel.setAttribute('font-style', 'italic');
            demandLabel.textContent = 'Demand';
            g.appendChild(demandLabel);

            const mcLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            mcLabel.setAttribute('x', width - margin.right - 80);
            mcLabel.setAttribute('y', yScale(0) - 10);
            mcLabel.setAttribute('font-size', '11');
            mcLabel.setAttribute('fill', '#666');
            mcLabel.setAttribute('font-style', 'italic');
            mcLabel.textContent = 'MC ≈ $0';
            g.appendChild(mcLabel);

            const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            yLabel.setAttribute('x', margin.left - 40);
            yLabel.setAttribute('y', margin.top - 12);
            yLabel.setAttribute('font-size', '11');
            yLabel.setAttribute('fill', '#666');
            yLabel.textContent = 'Willingness to Pay';
            g.appendChild(yLabel);

            const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            xLabel.setAttribute('x', width / 2);
            xLabel.setAttribute('y', height - margin.bottom + 32);
            xLabel.setAttribute('text-anchor', 'middle');
            xLabel.setAttribute('font-size', '11');
            xLabel.setAttribute('fill', '#666');
            xLabel.textContent = 'Potential Viewers';
            g.appendChild(xLabel);

            // CS Label - positioned above the demand line, over the blue triangle
            if (actualQ > 80) {
                const csLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                csLabel.setAttribute('x', xScale(chartWidth * 0.3));
                csLabel.setAttribute('y', margin.top - 8);
                csLabel.setAttribute('font-size', '13');
                csLabel.setAttribute('font-weight', '600');
                csLabel.setAttribute('fill', '#2E5C8A');
                csLabel.setAttribute('text-anchor', 'middle');
                csLabel.textContent = 'Consumer Surplus';
                g.appendChild(csLabel);
            }

            // DWL Label - positioned just above the demand line at the center of red triangle
            if (accessRate < 0.99 && (chartWidth - actualQ) > 80) {
                const dwlCenterX = (actualQ + chartWidth) / 2;
                // Calculate y position on demand line at this x position
                const progress = dwlCenterX / chartWidth;
                const yOnDemandLine = margin.top + progress * chartHeight;
                
                const dwlLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                dwlLabel.setAttribute('x', xScale(dwlCenterX));
                dwlLabel.setAttribute('y', yOnDemandLine - 4);
                dwlLabel.setAttribute('font-size', '13');
                dwlLabel.setAttribute('font-weight', '600');
                dwlLabel.setAttribute('fill', '#B83838');
                dwlLabel.setAttribute('text-anchor', 'middle');
                dwlLabel.textContent = 'Deadweight Loss';
                g.appendChild(dwlLabel);
            }

            svg.appendChild(g);
        }
        
        function updateChangesTimeline(year) {
            const change1 = document.getElementById('change1');
            const change2 = document.getElementById('change2');
            const change3 = document.getElementById('change3');
            
            change1.className = year >= 2009 ? 'change-item active' : 'change-item';
            change2.className = year >= 2005 ? 'change-item active' : 'change-item';
            change3.className = year >= 2014 ? 'change-item active' : 'change-item';
        }
        
        function updateVisualization(year) {
            const result = interpolate(year);
            const csPercent = Math.round(result.accessRate * 100);
            const dwlPercent = Math.round((1 - result.accessRate) * 100);
            
            document.getElementById('yearDisplay').textContent = year;
            document.getElementById('eraLabel').textContent = result.era;
            document.getElementById('csValue').textContent = `${csPercent}%`;
            document.getElementById('dwlValue').textContent = `${dwlPercent}%`;
            
            drawEconomicDiagram(result.accessRate);
            updateChangesTimeline(year);
        }
        
        const slider = document.getElementById('yearSlider');
        slider.addEventListener('input', (e) => {
            updateVisualization(parseInt(e.target.value));
        });

        // Auto-play animation
        let currentYear = 1967;
        const animationInterval = setInterval(() => {
            if (currentYear <= 2026) {
                slider.value = currentYear;
                updateVisualization(currentYear);
                currentYear += (currentYear < 2010 ? 3 : 1);
            } else {
                clearInterval(animationInterval);
            }
        }, currentYear < 2010 ? 100 : 250);

        // Initial render
        updateVisualization(1967);
    </script>
</body>
</html>